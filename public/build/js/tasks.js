!function(){!async function(){try{const t=`/api/tasks?id=${d()}`,n=await fetch(t),o=await n.json();e=o.tasks,s()}catch(e){console.log(e)}}();let e=[],t=[];document.querySelector("#add-task").addEventListener("click",function(){o(!1)});function n(n){const o=n.target.value;t=""!==o?e.filter(e=>e.STATUS===o):[],s()}function s(){!function(){const e=document.querySelector("#tasks-list");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.STATUS),n=document.querySelector("#new");0===t.length?n.disabled=!0:n.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.STATUS),n=document.querySelector("#completed");0===t.length?n.disabled=!0:n.disabled=!1}();const n=t.length?t:e;if(0===n.length){const e=document.querySelector("#tasks-list"),t=document.createElement("LI");return t.textContent="No tasks yet",t.classList.add("no-tasks"),void e.appendChild(t)}const a={0:"New",1:"Completed"};n.forEach(t=>{const n=document.createElement("LI");n.dataset.taskId=t.ID,n.classList.add("task");const l=document.createElement("P");l.textContent=t.TASK,l.ondblclick=function(){o(!0,{...t})};const i=document.createElement("DIV");i.classList.add("options");const r=document.createElement("BUTTON");r.classList.add("status-task"),r.classList.add(`${a[t.STATUS].toLowerCase()}`),r.textContent=a[t.STATUS],r.dataset.statusTask=t.STATUS,r.ondblclick=function(){!function(e){const t="1"===e.STATUS?"0":"1";e.STATUS=t,c(e)}({...t})};const u=document.createElement("BUTTON");u.classList.add("delete-task"),u.dataset.taskId=t.ID,u.textContent="Delete",u.ondblclick=function(){!function(t){Swal.fire({title:"Delete tasks?",showCancelButton:!0,confirmButtonText:"Yes",showCancelButtonText:"No"}).then(n=>{n.isConfirmed&&async function(t){const{ID:n,STATUS:o,TASK:a}=t,c=new FormData;c.append("ID",n),c.append("STATUS",o),c.append("TASK",a),c.append("PROJECT_ID",d());try{const n="http://localhost:3000/api/task/delete",o=await fetch(n,{method:"POST",body:c}),a=await o.json();a.result&&(Swal.fire("Task Deleted!",a.message,"success"),e=e.filter(e=>e.ID!==t.ID),s())}catch(e){console.log(e)}}(t)})}({...t})},i.appendChild(r),i.appendChild(u),n.appendChild(l),n.appendChild(i);document.querySelector("#tasks-list").appendChild(n)})}function o(t=!1,n={}){const o=document.createElement("DIV");o.classList.add("modal"),o.innerHTML=`\n        <form class="form new-task">\n            <legend>${t?"Edit Task":"Add a New Task"}</legend>\n                <div class="field">\n                    <label for="TASK">Task</label>\n                    <input \n                        type="text" \n                        name="TASK" \n                        id="TASK"\n                        placeholder="${n.TASK?"Edit Task":"Add a New Task"}"\n                        value="${n.TASK?n.TASK:""}"\n                    />\n                </div>\n                <div class="options">\n                    <input \n                        type="submit" \n                        value="${n.TASK?"Save Change":"Add Task"}"\n                        class="submit-new-task"\n                    />\n                    <button type="button" class="close-modal">Cancel</button>\n                </div>\n        </form>\n        `,setTimeout(()=>{document.querySelector(".form").classList.add("animate")},0),o.addEventListener("click",function(l){if(l.preventDefault(),l.target.classList.contains("close-modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{o.remove()},1e3)}if(l.target.classList.contains("submit-new-task")){const o=document.querySelector("#TASK").value.trim();if(""===o)return void a("The name task is required","error",document.querySelector(".form legend"));t?(n.TASK=o,c(n)):async function(t){const n=new FormData;n.append("TASK",t),n.append("PROJECT_ID",d());try{const o="http://localhost:3000/api/task",c=await fetch(o,{method:"POST",body:n}),d=await c.json();if(a(d.message,d.type,document.querySelector(".form legend")),"success"===d.type){const n=document.querySelector(".modal");setTimeout(()=>{n.remove()},3e3);const o={ID:String(d.ID),TASK:t,STATUS:"0",PROJECT_ID:d.PROJECT_ID};e=[...e,o],s()}}catch(e){console.log(e)}}(o)}}),document.querySelector(".dashboard").appendChild(o)}function a(e,t,n){const s=document.querySelector(".alert");s&&s.remove();const o=document.createElement("DIV");o.classList.add("alert",t),o.textContent=e,n.parentElement.insertBefore(o,n.nextElementSibling),setTimeout(()=>{o.remove()},5e3)}async function c(t){const{ID:n,PROJECT_ID:o,STATUS:a,TASK:c}=t,l=new FormData;l.append("ID",n),l.append("STATUS",a),l.append("TASK",c),l.append("PROJECT_ID",d());try{const t="http://localhost:3000/api/task/update",o=await fetch(t,{method:"POST",body:l}),d=await o.json();if("success"===d.response.type){Swal.fire(d.response.message,"","success");const t=document.querySelector(".modal");t&&t.remove(),e=e.map(e=>(e.ID===n&&(e.STATUS=a,e.TASK=c),e)),s()}}catch(e){console.log(e)}}function d(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}document.querySelectorAll('#filters input[type="radio"]').forEach(e=>{e.addEventListener("input",n)})}();