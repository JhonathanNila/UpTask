!function(){!async function(){try{const n=`/api/tasks?id=${o()}`,s=await fetch(n),a=await s.json();e=a.tasks,t()}catch(e){console.log(e)}}();let e=[];function t(){if(function(){const e=document.querySelector("#tasks-list");for(;e.firstChild;)e.removeChild(e.firstChild)}(),0===e.length){const e=document.querySelector("#tasks-list"),t=document.createElement("LI");return t.textContent="No tasks yet",t.classList.add("no-tasks"),void e.appendChild(t)}const s={0:"New",1:"Completed"};e.forEach(c=>{const d=document.createElement("LI");d.dataset.taskId=c.ID,d.classList.add("task");const l=document.createElement("P");l.textContent=c.TASK,l.ondblclick=function(){n(!0,{...c})};const i=document.createElement("DIV");i.classList.add("options");const r=document.createElement("BUTTON");r.classList.add("status-task"),r.classList.add(`${s[c.STATUS].toLowerCase()}`),r.textContent=s[c.STATUS],r.dataset.statusTask=c.STATUS,r.ondblclick=function(){!function(e){const t="1"===e.STATUS?"0":"1";e.STATUS=t,a(e)}({...c})};const u=document.createElement("BUTTON");u.classList.add("delete-task"),u.dataset.taskId=c.ID,u.textContent="Delete",u.ondblclick=function(){!function(n){Swal.fire({title:"Delete tasks?",showCancelButton:!0,confirmButtonText:"Yes",showCancelButtonText:"No"}).then(s=>{s.isConfirmed&&async function(n){const{ID:s,STATUS:a,TASK:c}=n,d=new FormData;d.append("ID",s),d.append("STATUS",a),d.append("TASK",c),d.append("PROJECT_ID",o());try{const s="http://localhost:3000/api/task/delete",a=await fetch(s,{method:"POST",body:d}),o=await a.json();o.result&&(Swal.fire("Task Deleted!",o.message,"success"),e=e.filter(e=>e.ID!==n.ID),t())}catch(e){console.log(e)}}(n)})}({...c})},i.appendChild(r),i.appendChild(u),d.appendChild(l),d.appendChild(i);document.querySelector("#tasks-list").appendChild(d)})}function n(n=!1,c={}){const d=document.createElement("DIV");d.classList.add("modal"),d.innerHTML=`\n        <form class="form new-task">\n            <legend>${n?"Edit Task":"Add a New Task"}</legend>\n                <div class="field">\n                    <label for="TASK">Task</label>\n                    <input \n                        type="text" \n                        name="TASK" \n                        id="TASK"\n                        placeholder="${c.TASK?"Edit Task":"Add a New Task"}"\n                        value="${c.TASK?c.TASK:""}"\n                    />\n                </div>\n                <div class="options">\n                    <input \n                        type="submit" \n                        value="${c.TASK?"Save Change":"Add Task"}"\n                        class="submit-new-task"\n                    />\n                    <button type="button" class="close-modal">Cancel</button>\n                </div>\n        </form>\n        `,setTimeout(()=>{document.querySelector(".form").classList.add("animate")},0),d.addEventListener("click",function(l){if(l.preventDefault(),l.target.classList.contains("close-modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{d.remove()},1e3)}if(l.target.classList.contains("submit-new-task")){const d=document.querySelector("#TASK").value.trim();if(""===d)return void s("The name task is required","error",document.querySelector(".form legend"));n?(c.TASK=d,a(c)):async function(n){const a=new FormData;a.append("TASK",n),a.append("PROJECT_ID",o());try{const o="http://localhost:3000/api/task",c=await fetch(o,{method:"POST",body:a}),d=await c.json();if(s(d.message,d.type,document.querySelector(".form legend")),"success"===d.type){const s=document.querySelector(".modal");setTimeout(()=>{s.remove()},3e3);const a={ID:String(d.ID),TASK:n,STATUS:"0",PROJECT_ID:d.PROJECT_ID};e=[...e,a],t()}}catch(e){console.log(e)}}(d)}}),document.querySelector(".dashboard").appendChild(d)}function s(e,t,n){const s=document.querySelector(".alert");s&&s.remove();const a=document.createElement("DIV");a.classList.add("alert",t),a.textContent=e,n.parentElement.insertBefore(a,n.nextElementSibling),setTimeout(()=>{a.remove()},5e3)}async function a(n){const{ID:s,PROJECT_ID:a,STATUS:c,TASK:d}=n,l=new FormData;l.append("ID",s),l.append("STATUS",c),l.append("TASK",d),l.append("PROJECT_ID",o());try{const n="http://localhost:3000/api/task/update",a=await fetch(n,{method:"POST",body:l}),o=await a.json();if("success"===o.response.type){Swal.fire(o.response.message,"","success");const n=document.querySelector(".modal");n&&n.remove(),e=e.map(e=>(e.ID===s&&(e.STATUS=c,e.TASK=d),e)),t()}}catch(e){console.log(e)}}function o(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}document.querySelector("#add-task").addEventListener("click",function(){n(!1)})}();